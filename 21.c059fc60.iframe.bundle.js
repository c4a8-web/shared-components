(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"./assets/js/modal.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__("./node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("./node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("./node_modules/core-js/modules/web.timers.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");var _state_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./assets/js/state.js"),_components_form_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./assets/js/components/form.js"),_components_form_attachments_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./assets/js/components/form-attachments.js"),_recruiter_box_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./assets/js/recruiter-box.js"),_tools_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./assets/js/tools.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Modal=function(){function Modal(root,options){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Modal),this.root=root,this.options=options,this.closeSelector=".modal__close",this.successCloseSelector=".modal__success-close .cta",this.applicationSelector=".modal__application",this.modalSuccessHeadlineSelector=".modal__success-headline > *",this.buttonSelector='[data-trigger="modal"]',this.formSelector=".form",this.close=this.root.querySelector(this.closeSelector),this.successClose=this.root.querySelector(this.successCloseSelector),this.application=this.root.querySelector(this.applicationSelector),this.form=this.root.querySelector(this.formSelector),this.root.classList.add(_state_js__WEBPACK_IMPORTED_MODULE_5__.a.READY),this.application&&(this.clientName=this.root.dataset.clientName,this.apiUrl=this.root.dataset.apiUrl,this.jobId=this.root.dataset.jobId,this.api=new _recruiter_box_js__WEBPACK_IMPORTED_MODULE_8__.a(Object.assign({},this.jobId&&{jobId:this.jobId},this.apiUrl&&{apiUrl:this.apiUrl},{client_name:this.clientName}))),this.bindEvents()}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(Modal,[{key:"bindEvents",value:function bindEvents(){var _this$close,_this$successClose;if(null===(_this$close=this.close)||void 0===_this$close||_this$close.addEventListener("click",this.handleClose.bind(this)),null===(_this$successClose=this.successClose)||void 0===_this$successClose||_this$successClose.addEventListener("click",this.handleClose.bind(this)),this.application){var parent=_tools_js__WEBPACK_IMPORTED_MODULE_9__.a.getParentComponent(this.root),formInstance=_components_form_js__WEBPACK_IMPORTED_MODULE_6__.default.getInstance(this.form);if(parent){var button=parent.querySelector(this.buttonSelector);null==button||button.addEventListener("click",this.handleOpen.bind(this))}formInstance&&(formInstance.customSubmit=this.handleApplicationSubmit.bind(this))}}},{key:"handleApplicationSubmit",value:function handleApplicationSubmit(e){var _this=this;e.preventDefault(),e.stopImmediatePropagation();var fileData,base64=this.form.querySelector(_components_form_attachments_js__WEBPACK_IMPORTED_MODULE_7__.default.base64Selector),base64Value=null==base64?void 0:base64.value,fields=this.api.getFormData(this.form);if(base64Value)fileData={name:base64.dataset.fileName};else{var fileInput=this.form.querySelector('input[type="file"]');fileData=null==fileInput?void 0:fileInput.files[0]}fileData?base64Value?(fields=this.api.applyFileData(fileData,base64Value,fields),this.handleApplicationRequest(fields)):_tools_js__WEBPACK_IMPORTED_MODULE_9__.a.toBase64(fileData).then((function(data){fields=_this.api.applyFileData(fileData,data,fields),_this.handleApplicationRequest(fields)})):(console.error("handle generic error no files"),this.handleError())}},{key:"handleApplicationRequest",value:function handleApplicationRequest(fields){var _this2=this;this.api.handleApply(fields).then((function(){_this2.handleApplicationSuccess(fields)})).catch((function(){_this2.handleError()}))}},{key:"handleApplicationSuccess",value:function handleApplicationSuccess(fields){this.root.classList.add(_state_js__WEBPACK_IMPORTED_MODULE_5__.a.SUCCESS);var modalSuccessHeadline=this.root.querySelector(this.modalSuccessHeadlineSelector);if(modalSuccessHeadline){modalSuccessHeadline.dataset.text||(modalSuccessHeadline.dataset.text=modalSuccessHeadline.innerText);var firstName=fields[0];modalSuccessHeadline.innerText=modalSuccessHeadline.dataset.text+" "+firstName.value}}},{key:"handleError",value:function handleError(){console.error("error modal")}},{key:"handleClose",value:function handleClose(e){e.preventDefault(),Modal.close(this.root)}},{key:"handleOpen",value:function handleOpen(e){e.preventDefault(),Modal.open(this.root)}}],[{key:"initElement",value:function initElement(element,options){var instance=new this(element,options);return this.instances.push(instance),instance}},{key:"open",value:function open(element){window.$&&$(element).modal("show")}},{key:"close",value:function close(element){window.$&&($(element).modal("hide"),Modal.resetModal(element))}},{key:"resetModal",value:function resetModal(element){setTimeout((function(){var form=element.querySelector("form");null==form||form.reset(),element.classList.remove(_state_js__WEBPACK_IMPORTED_MODULE_5__.a.SUCCESS)}),200)}},{key:"init",value:function init(element){var _this3=this;this.instances=[];var selectedElement=element||document,notReadySelector=this.rootSelector+":not(."+_state_js__WEBPACK_IMPORTED_MODULE_5__.a.READY+")";[].forEach.call(selectedElement.querySelectorAll(notReadySelector),(function(element){_this3.initElement(element)}))}}]),Modal}();Modal.rootSelector=".modal",Modal.instances=[],__webpack_exports__.default=Modal},"./assets/js/recruiter-box.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__("./node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("./node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("./node_modules/core-js/modules/es.string.split.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("./node_modules/core-js/modules/es.string.replace.js"),__webpack_require__("./node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("./node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("./node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("./node_modules/core-js/modules/es.string.match.js"),__webpack_require__("./node_modules/core-js/modules/es.function.name.js"),__webpack_require__("./node_modules/core-js/modules/es.promise.js"),__webpack_require__("./node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("./node_modules/core-js/modules/es.object.define-property.js");var _tools_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./assets/js/tools.js");function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var RecruiterBox=function(){function RecruiterBox(options){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RecruiterBox),this.apiUrl="https://jsapi.recruiterbox.com/v1/",this.openingsUrl=this.apiUrl+"openings",this.types={OPENINGS:"openings"},this.langTagPrefix="lang_",this.hiddenTag="hidden",this.mockApplyUrl="mock/jobApply.json",this.options=options,this.filter="",this.options.jobId=this.getJobId()}var _apply;return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(RecruiterBox,[{key:"getJobId",value:function getJobId(){var jobId="",hash=window.location.hash;if(hash)if(-1!==hash.indexOf("-")){var splitHash=hash.split("-");jobId=splitHash[splitHash.length-1]}else jobId=hash.substr(1);else this.options.jobId&&(jobId=this.options.jobId);return jobId}},{key:"getLangFromEntry",value:function getLangFromEntry(entry){var _langs$,_this=this;return(null===(_langs$=(null==entry?void 0:entry.tags.filter((function(value,_){return 0===value.indexOf(_this.langTagPrefix)})))[0])||void 0===_langs$?void 0:_langs$.replace(this.langTagPrefix,""))||null}},{key:"setLang",value:function setLang(lang){this.setFilter({tags:this.langTagPrefix+lang})}},{key:"setFilter",value:function setFilter(params){var _this2=this;params&&Object.keys(params).forEach((function(key){_this2.filter+="&"+key+"="+params[key]}))}},{key:"getUrl",value:function getUrl(type,params,action){var _this$options$apiUrl,_this$options,idParam=params?"/"+params+"/"+(null!=action?action:""):"";return""+(null!==(_this$options$apiUrl=this.options.apiUrl)&&void 0!==_this$options$apiUrl&&_this$options$apiUrl.match(/.json$/)&&action?this.mockApplyUrl:this.options.apiUrl?this.options.apiUrl:this[type+"Url"])+(this.options.apiUrl?"":idParam+"?client_name="+(null===(_this$options=this.options)||void 0===_this$options?void 0:_this$options.client_name))+(this.options.apiUrl?"":this.filter)}},{key:"getAll",value:function getAll(){var url=this.getUrl(this.types.OPENINGS);return this.fetch(url)}},{key:"getOpening",value:function getOpening(){var _this$options2,url=this.getUrl(this.types.OPENINGS,null===(_this$options2=this.options)||void 0===_this$options2?void 0:_this$options2.jobId);return this.fetch(url)}},{key:"getFormData",value:function getFormData(form){if(null==form)return[];for(var inputs=form.querySelectorAll('input[type="text"], input[type="email"], textarea'),data=[],customFields=["cancellation","salary","message"],_loop=function _loop(i){var input=inputs[i],value=void 0;"text"!==input.type&&"email"!==input.type&&"TEXTAREA"!==input.tagName||(value=input.value);var key=customFields.filter((function(value){return value===input.name})).length?input.name:"candidate_"+_tools_js__WEBPACK_IMPORTED_MODULE_15__.a.camalCaseToSnakeCase(input.name);data.push({key:key,value:value})},i=0;i<inputs.length;i++)_loop(i);return data}},{key:"applyFileData",value:function applyFileData(fileData,data,fields){var file={key:"resume",value:{encoded_data:data,file_name:fileData.name}};return fields.push(file),fields}},{key:"isValidResponseCode",value:function isValidResponseCode(response){return this.options.apiUrl?200===response.status:201===response.status||204===response.status}},{key:"handleApply",value:function handleApply(fields){var _this3=this;return new Promise((function(resolve,reject){_this3.apply({fields:fields}).then((function(response){if(_this3.isValidResponseCode(response))return resolve();response.json().then((function(jsonResponse){if(jsonResponse.errors)return reject(jsonResponse.errors)})).catch((function(error){return reject(error)}))})).catch((function(error){return reject(error)}))}))}},{key:"apply",value:(_apply=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(fields){var _this$options3,url;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return url=this.getUrl(this.types.OPENINGS,null===(_this$options3=this.options)||void 0===_this$options3?void 0:_this$options3.jobId,"apply"),_context.abrupt("return",this.fetch(url,{method:"POST",body:JSON.stringify(fields),headers:{"Content-Type":"application/json"}}));case 2:case"end":return _context.stop()}}),_callee,this)}))),function apply(_x3){return _apply.apply(this,arguments)})},{key:"fetch",value:function(_fetch){function fetch(_x,_x2){return _fetch.apply(this,arguments)}return fetch.toString=function(){return _fetch.toString()},fetch}((function(url,options){var _this4=this;return new Promise((function(resolve,reject){var _this4$options;null!==(_this4$options=_this4.options)&&void 0!==_this4$options&&_this4$options.client_name?resolve(fetch(url,options)):reject("no client_name specified")}))}))}]),RecruiterBox}();__webpack_exports__.a=RecruiterBox}}]);